(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 14.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     55042,       1269]
NotebookOptionsPosition[     53966,       1245]
NotebookOutlinePosition[     54378,       1262]
CellTagsIndexPosition[     54335,       1259]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.929156557322071*^9, 3.929156568852981*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"7096a7b1-5235-6346-b3f9-6bae6010e095"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\:521d\:59cb\:5316\:51fd\:6570", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"initialization", "[", 
    RowBox[{"pop_", ",", "ub_", ",", "lb_", ",", "dim_"}], "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"X", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "pop"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "dim"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"X", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ub", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "-", 
            RowBox[{"lb", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], ")"}], "*", 
          RowBox[{"RandomReal", "[", "]"}]}], "+", 
         RowBox[{"lb", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "pop"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "dim"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "X"}], "\[IndentingNewLine]", ")"}]}]}]], "Input",
 CellChangeTimes->{{3.929067965299225*^9, 3.929068002723732*^9}, {
   3.929068158654365*^9, 3.929068299108299*^9}, {3.929068578174362*^9, 
   3.929068578580035*^9}, 3.929068666439993*^9, {3.929068738998684*^9, 
   3.929068749632384*^9}, {3.92916534535186*^9, 3.929165358749342*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"b1a89bed-3815-1248-b9d2-b152b600caad"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\:8fb9\:754c\:68c0\:67e5\:51fd\:6570", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"boundaryCheck", "[", 
    RowBox[{"x_", ",", "ub_", ",", "lb_", ",", "dim_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"xNew", "=", "x"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"xNew", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ">", 
            RowBox[{"ub", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"xNew", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{"ub", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"xNew", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "<", 
            RowBox[{"lb", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"xNew", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{"lb", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], ";"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "xNew", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "xNew"}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9290689462264957`*^9, 3.929069000311102*^9}, {
  3.929069209772405*^9, 3.929069310156538*^9}, {3.9290694430826473`*^9, 
  3.929069464558664*^9}, {3.929150411338463*^9, 3.929150447515978*^9}, {
  3.9291505052211075`*^9, 3.929150544713953*^9}, {3.929165361936388*^9, 
  3.929165367088068*^9}, {3.929165402485632*^9, 3.9291654077562428`*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"b0ed6135-d962-084c-a27b-3ffa03db796c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\:79c3\:9e70\:641c\:7d22\:7b97\:6cd5", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"BES", "[", 
    RowBox[{
    "pop_", ",", "dim_", ",", "ub_", ",", "lb_", ",", "fobj_", ",", 
     "maxiter_"}], "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"itercurve", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "maxiter"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", "\:79cd\:7fa4\:521d\:59cb\:5316", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"X", "=", 
      RowBox[{"initialization", "[", 
       RowBox[{"pop", ",", "ub", ",", "lb", ",", "dim"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", "\:8ba1\:7b97\:9002\:5e94\:5ea6", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"fitness", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"fobj", "[", 
         RowBox[{"X", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", ";;"}], "]"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "pop"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
     "(*", "\:83b7\:53d6\:6700\:5c0f\:9002\:5e94\:5ea6\:7d22\:5f15", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"minindex", "=", 
      RowBox[{
       RowBox[{"Ordering", "[", "fitness", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
     "(*", "\:83b7\:53d6\:79cd\:7fa4\:6700\:4f18\:4e2a\:4f53\:641c\:7d22\:4f4d\
\:7f6e\:53ca\:9002\:5e94\:5ea6", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"bestpos", "=", 
      RowBox[{"X", "[", 
       RowBox[{"[", 
        RowBox[{"minindex", ",", ";;"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"bestfitness", "=", 
      RowBox[{"fitness", "[", 
       RowBox[{"[", "minindex", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", "\:8fed\:4ee3", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
      "(*", "\:79c3\:9e70\:5e73\:5747\:5206\:5e03\:4f4d\:7f6e", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Pmean", "=", 
         RowBox[{"Mean", "[", "X", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", "\:9009\:62e9\:9636\:6bb5", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"alpha", "=", "2"}], ";", "\[IndentingNewLine]", 
           RowBox[{"r", "=", 
            RowBox[{
             RowBox[{"RandomReal", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "dim"}], "}"}]}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"\:539f\:5f0f\:4e3abestpos", "+", 
              RowBox[{"alpha", "*", "r", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"X", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", ";;"}], "]"}], "]"}], "-", "Pmean"}], 
                ")"}]}]}], "\:ff0c", 
             "\:7531\:4e8e\:8fed\:4ee3\:540e\:671f\:79c3\:9e70\:53d1\:751f\
\:96c6\:805a", "\:ff0c", "\:641c\:7d22\:8303\:56f4\:8fc7\:5c0f", "\:ff0c", 
             "\:6545\:6dfb\:52a0\:641c\:7d22\:8303\:56f4\:4e0b\:9650"}], 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"X", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", ";;"}], "]"}], "]"}], "=", 
            RowBox[{"bestpos", "+", 
             RowBox[{"r", "*", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"Max", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Abs", "[", 
                    RowBox[{"alpha", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Pmean", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"X", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", ";;"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], ")"}]}], "]"}], ",", 
                   RowBox[{"searchRange", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"ub", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "-", 
                    RowBox[{"lb", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                 ",", 
                RowBox[{"{", 
                 RowBox[{"n", ",", "1", ",", "dim"}], "}"}]}], "]"}]}]}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"X", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", ";;"}], "]"}], "]"}], "=", 
            RowBox[{"boundaryCheck", "[", 
             RowBox[{
              RowBox[{"X", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", ";;"}], "]"}], "]"}], ",", "ub", ",", "lb", 
              ",", "dim"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"fitness", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{"fobj", "[", 
             RowBox[{"X", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", ";;"}], "]"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"fitness", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "<", "bestfitness"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"bestfitness", "=", 
               RowBox[{"fitness", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"bestpos", "=", 
               RowBox[{"X", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", ";;"}], "]"}], "]"}]}]}]}], "]"}]}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "pop"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Pmean", "=", 
         RowBox[{"Mean", "[", "X", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", "\:641c\:7d22\:9636\:6bb5", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"a", "=", "10"}], ";", "\[IndentingNewLine]", 
           RowBox[{"R", "=", "1.5"}], ";", "\[IndentingNewLine]", 
           RowBox[{"theta", "=", 
            RowBox[{
             RowBox[{"a", "*", "Pi", "*", 
              RowBox[{"RandomReal", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "1"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"pop", ",", "1"}], "}"}]}], "]"}]}], "//", 
             "Flatten"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"r", "=", 
            RowBox[{
             RowBox[{"theta", "+", 
              RowBox[{"R", "*", 
               RowBox[{"RandomReal", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"pop", ",", "1"}], "}"}]}], "]"}]}]}], "//", 
             "Flatten"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"xr", "=", 
            RowBox[{"r", "*", 
             RowBox[{"Sin", "[", "theta", "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"yr", "=", 
            RowBox[{"r", "*", 
             RowBox[{"Cos", "[", "theta", "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"x", "=", 
            RowBox[{"xr", "/", 
             RowBox[{"Max", "[", 
              RowBox[{"Abs", "[", "xr", "]"}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"y", "=", 
            RowBox[{"yr", "/", 
             RowBox[{"Max", "[", 
              RowBox[{"Abs", "[", "yr", "]"}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"X", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", ";;"}], "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"X", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", ";;"}], "]"}], "]"}], "+", 
             RowBox[{
              RowBox[{"y", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"X", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", ";;"}], "]"}], "]"}], "-", 
                RowBox[{"X", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"i", "+", "1"}], ",", ";;"}], "]"}], "]"}]}], 
               ")"}]}], "+", 
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"X", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", ";;"}], "]"}], "]"}], "-", "Pmean"}], 
               ")"}]}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"X", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", ";;"}], "]"}], "]"}], "=", 
            RowBox[{"boundaryCheck", "[", 
             RowBox[{
              RowBox[{"X", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", ";;"}], "]"}], "]"}], ",", "ub", ",", "lb", 
              ",", "dim"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"fitness", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{"fobj", "[", 
             RowBox[{"X", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", ";;"}], "]"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"fitness", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "<", "bestfitness"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"bestfitness", "=", 
               RowBox[{"fitness", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"bestpos", "=", 
               RowBox[{"X", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", ";;"}], "]"}], "]"}]}]}]}], "]"}]}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"pop", "-", "1"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Pmean", "=", 
         RowBox[{"Mean", "[", "X", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", "\:4fef\:51b2\:9636\:6bb5", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
         "(*", "\:6b64\:5904\:4ee3\:7801\:66f4\:6539\:4e3a\:66f4\:771f\:5b9e\
\:7684\:4fef\:51b2\:60c5\:5f62", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"a", "=", "1"}], ";", "\[IndentingNewLine]", 
           RowBox[{"c1", "=", "1"}], ";", "\[IndentingNewLine]", 
           RowBox[{"c2", "=", "1"}], ";", "\[IndentingNewLine]", 
           RowBox[{"theta", "=", 
            RowBox[{
             RowBox[{"a", "*", "Pi", "*", 
              RowBox[{"RandomReal", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "1"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"pop", ",", "1"}], "}"}]}], "]"}]}], "//", 
             "Flatten"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"r", "=", "theta"}], ";", "\[IndentingNewLine]", 
           RowBox[{"xr", "=", 
            RowBox[{"r", "*", 
             RowBox[{"Sinh", "[", "theta", "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"yr", "=", 
            RowBox[{"r", "*", 
             RowBox[{"Cosh", "[", "theta", "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"x", "=", 
            RowBox[{"xr", "/", 
             RowBox[{"Max", "[", 
              RowBox[{"Abs", "[", "xr", "]"}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"y", "=", 
            RowBox[{"yr", "/", 
             RowBox[{"Max", "[", 
              RowBox[{"Abs", "[", "yr", "]"}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"deltax", "=", 
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"X", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", ";;"}], "]"}], "]"}], "-", 
               RowBox[{"c1", "*", "Pmean"}]}], ")"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"deltay", "=", 
            RowBox[{
             RowBox[{"y", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"X", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", ";;"}], "]"}], "]"}], "-", 
               RowBox[{"c2", "*", "bestpos"}]}], ")"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"X", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", ";;"}], "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{
              RowBox[{"RandomReal", "[", 
               RowBox[{"NormalDistribution", "[", 
                RowBox[{"1", ",", 
                 RowBox[{
                  SuperscriptBox["10", 
                   RowBox[{"-", "1"}]], "/", "2"}]}], "]"}], "]"}], "*", 
              "bestpos"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"deltax", "+", "deltay"}], ")"}], "/", "2"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"X", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", ";;"}], "]"}], "]"}], "=", 
            RowBox[{"boundaryCheck", "[", 
             RowBox[{
              RowBox[{"X", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", ";;"}], "]"}], "]"}], ",", "ub", ",", "lb", 
              ",", "dim"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"fitness", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{"fobj", "[", 
             RowBox[{"X", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", ";;"}], "]"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"fitness", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "<", "bestfitness"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"bestfitness", "=", 
               RowBox[{"fitness", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"bestpos", "=", 
               RowBox[{"X", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", ";;"}], "]"}], "]"}]}]}]}], "]"}]}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "pop"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
        "(*", "\:8bb0\:5f55\:5f53\:524d\:8fed\:4ee3\:7684\:6700\:4f18\:89e3\
\:9002\:5e94\:5ea6", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"itercurve", "[", 
          RowBox[{"[", "t", "]"}], "]"}], "=", "bestfitness"}], ";"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "1", ",", "maxiter"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"bestpos", ",", "bestfitness", ",", "itercurve"}], "}"}]}], 
    ")"}]}]}]], "Input",
 CellChangeTimes->{{3.929411545581963*^9, 3.929411781508673*^9}, {
   3.929411825553264*^9, 3.929412085861613*^9}, {3.9294121896389*^9, 
   3.929412216389681*^9}, {3.9294122555576057`*^9, 3.9294126171970425`*^9}, {
   3.929412682816145*^9, 3.9294129567715435`*^9}, {3.929413241745524*^9, 
   3.929413242484118*^9}, {3.9294133318950043`*^9, 3.929413339386205*^9}, {
   3.929413444117349*^9, 3.929413444308094*^9}, 3.929413557469145*^9, {
   3.929414353370417*^9, 3.929414357239229*^9}, {3.929414422865789*^9, 
   3.9294144256925144`*^9}, {3.9294144604933453`*^9, 3.929414460936787*^9}, {
   3.929414520559166*^9, 3.9294145353985023`*^9}, {3.929414987753847*^9, 
   3.929414988473698*^9}, {3.929415182020248*^9, 3.929415208466524*^9}, {
   3.929415250533428*^9, 3.92941525203574*^9}, {3.9294155421887627`*^9, 
   3.929415543493967*^9}, {3.929417285116328*^9, 3.929417311590323*^9}, 
   3.929417723684994*^9, {3.929417767413037*^9, 3.929417769920601*^9}, {
   3.929418134431618*^9, 3.929418145520944*^9}, 3.929418475447691*^9, {
   3.929418973574604*^9, 3.929418975754768*^9}, 3.929419085698929*^9, {
   3.929419308981676*^9, 3.929419310373529*^9}, 3.929419374915386*^9, {
   3.929419493412718*^9, 3.929419530998111*^9}, {3.9294200540449257`*^9, 
   3.929420070196532*^9}, {3.929420272973793*^9, 3.9294204048853817`*^9}, {
   3.92942058383337*^9, 3.929420600216501*^9}, {3.9294209690351143`*^9, 
   3.9294212279235897`*^9}, {3.929421277014778*^9, 3.9294214269873276`*^9}, {
   3.9294215740742607`*^9, 3.9294216045416603`*^9}, {3.92942163930995*^9, 
   3.929421757440548*^9}, {3.929421822921753*^9, 3.929421840369709*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"f980bcba-8dbd-544d-9439-fd651664fb40"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dataneed", "=", 
   RowBox[{"Part", "[", 
    RowBox[{
     RowBox[{
     "Import", "@", 
      "\"\<C:\\\\Users\\\\PC\\\\Desktop\\\\\:7535\:5de5\:676f\\\\\:8d5b\:9898\
\:4ee5\:53ca\:6570\:636eA\\\\\:9644\:4ef61\:ff1a\:5404\:56ed\:533a\:5178\:578b\
\:65e5\:8d1f\:8377\:6570\:636e.csv\>\""}], ",", 
     RowBox[{"2", ";;"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", "A\:5730\:8d1f\:8377", "*)"}], 
  RowBox[{
   RowBox[{"dataAneed", "=", 
    RowBox[{"1.5", "*", 
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"#2", "&"}], "@@@", "dataneed"}], ",", 
       RowBox[{"-", "2"}]}], "]"}]}]}], ";"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", "B\:5730\:8d1f\:8377", "*)"}], 
  RowBox[{
   RowBox[{"dataBneed", "=", 
    RowBox[{"1.5", "*", 
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"#3", "&"}], "@@@", "dataneed"}], ",", 
       RowBox[{"-", "2"}]}], "]"}]}]}], ";"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", "C\:5730\:8d1f\:8377", "*)"}], 
  RowBox[{
   RowBox[{"dataCneed", "=", 
    RowBox[{"1.5", "*", 
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"#4", "&"}], "@@@", "dataneed"}], ",", 
       RowBox[{"-", "2"}]}], "]"}]}]}], ";"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dataproduce", "=", 
   RowBox[{"Part", "[", 
    RowBox[{
     RowBox[{
     "Import", "@", 
      "\"\<C:\\\\Users\\\\PC\\\\Desktop\\\\\:7535\:5de5\:676f\\\\\:8d5b\:9898\
\:4ee5\:53ca\:6570\:636eA\\\\\:9644\:4ef62\:ff1a\:5404\:56ed\:533a\:5178\:578b\
\:65e5\:98ce\:5149\:53d1\:7535\:6570\:636e.csv\>\""}], ",", 
     RowBox[{"4", ";;"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", "A\:5730\:53d1\:7535\:91cf", "*)"}], 
  RowBox[{
   RowBox[{"dataAproduce", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"750", "*", "#2"}], "&"}], "@@@", "dataproduce"}]}], 
   ";"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", "B\:5730\:53d1\:7535\:91cf", "*)"}], 
  RowBox[{
   RowBox[{"dataBproduce", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"1000", "*", "#3"}], "&"}], "@@@", "dataproduce"}]}], 
   ";"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", "C\:5730\:5149\:80fd\:53d1\:7535\:91cf", "*)"}], 
  RowBox[{
   RowBox[{"dataCproducelight", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"600", "*", "#4"}], "&"}], "@@@", "dataproduce"}]}], 
   ";"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", "C\:5730\:98ce\:80fd\:53d1\:7535\:91cf", "*)"}], 
  RowBox[{
   RowBox[{"dataCproducewind", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"500", "*", "#5"}], "&"}], "@@@", "dataproduce"}]}], 
   ";"}]}]}], "Input",
 CellChangeTimes->{{3.925500640418431*^9, 3.925500687883127*^9}, {
   3.9255007200110836`*^9, 3.9255007324855556`*^9}, {3.92550080687702*^9, 
   3.925500921772743*^9}, {3.9255009651834984`*^9, 3.925500973093704*^9}, {
   3.925501077828671*^9, 3.925501341734343*^9}, {3.925501406292801*^9, 
   3.925501413729858*^9}, {3.925501592276985*^9, 3.925501596439934*^9}, {
   3.925522771523419*^9, 3.925522775184379*^9}, {3.9255228988146152`*^9, 
   3.925522900913463*^9}, 3.925522948651696*^9, {3.925525287721756*^9, 
   3.925525360071596*^9}, {3.925527367749527*^9, 3.925527413176628*^9}, 
   3.925532306356339*^9, 3.925542487855831*^9, 3.9255893951316223`*^9, {
   3.925698484389843*^9, 3.925698533555786*^9}, {3.925700681814081*^9, 
   3.925700685362477*^9}, {3.925797852133198*^9, 3.92579785380249*^9}, {
   3.925798110194067*^9, 3.92579811052841*^9}, {3.925799215443903*^9, 
   3.925799222317217*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"2735c565-00ce-4149-8a2f-972ce4c55af6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\:7535\:5de5\:676f\:6d4b\:8bd5\:51fd\:6570", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"moneyC", "=", 
     RowBox[{"ebuynetC", "=", 
      RowBox[{"ebuywindC", "=", 
       RowBox[{"ebuylightC", "=", 
        RowBox[{"wasteC", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"i", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "24"}], "}"}]}], "]"}]}]}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"daypriceC", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1825"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"saveC", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "25"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"findminC", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"power_", "?", "NumericQ"}], ",", 
       RowBox[{"energy_", "?", "NumericQ"}], ",", 
       RowBox[{"pv_", "?", "NumericQ"}], ",", 
       RowBox[{"pw_", "?", "NumericQ"}]}], "}"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "sumpriceC", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", "C\:5730\:5149\:80fd\:53d1\:7535\:91cf", "*)"}], 
      RowBox[{
       RowBox[{"dataCproducelight", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"pv", "*", "#4"}], "&"}], "@@@", "dataproduce"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", "C\:5730\:98ce\:80fd\:53d1\:7535\:91cf", "*)"}], 
       RowBox[{"dataCproducewind", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"pw", "*", "#5"}], "&"}], "@@@", "dataproduce"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"saveC", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", 
        RowBox[{"energy", "*", "0.1"}]}], ";", "\n", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"dataCneed", "[", 
                 RowBox[{"[", "hour", "]"}], "]"}], "<", 
                RowBox[{"dataCproducelight", "[", 
                 RowBox[{"[", "hour", "]"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"ebuylightC", "[", 
                  RowBox[{"[", "hour", "]"}], "]"}], "=", 
                 RowBox[{"dataCneed", "[", 
                  RowBox[{"[", "hour", "]"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"ebuywindC", "[", 
                  RowBox[{"[", "hour", "]"}], "]"}], "=", "0"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"ebuynetC", "[", 
                  RowBox[{"[", "hour", "]"}], "]"}], "=", "0"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"wasteC", "[", 
                  RowBox[{"[", "hour", "]"}], "]"}], "=", 
                 RowBox[{
                  RowBox[{"dataCproducelight", "[", 
                   RowBox[{"[", "hour", "]"}], "]"}], "+", 
                  RowBox[{"dataCproducewind", "[", 
                   RowBox[{"[", "hour", "]"}], "]"}], "-", 
                  RowBox[{"dataCneed", "[", 
                   RowBox[{"[", "hour", "]"}], "]"}], "-", 
                  RowBox[{"Min", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"dataCproducelight", "[", 
                    RowBox[{"[", "hour", "]"}], "]"}], "+", 
                    RowBox[{"dataCproducewind", "[", 
                    RowBox[{"[", "hour", "]"}], "]"}], "-", 
                    RowBox[{"dataCneed", "[", 
                    RowBox[{"[", "hour", "]"}], "]"}]}], ")"}], ",", 
                    "power"}], "}"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"moneyC", "[", 
                  RowBox[{"[", "hour", "]"}], "]"}], "=", 
                 RowBox[{
                  RowBox[{"0.4", "*", 
                   RowBox[{"ebuylightC", "[", 
                    RowBox[{"[", "hour", "]"}], "]"}]}], "+", 
                  RowBox[{"0.5", "*", 
                   RowBox[{"ebuywindC", "[", 
                    RowBox[{"[", "hour", "]"}], "]"}]}], "+", 
                  RowBox[{"1", "*", 
                   RowBox[{"ebuynetC", "[", 
                    RowBox[{"[", "hour", "]"}], "]"}]}]}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"saveC", "[", 
                  RowBox[{"[", 
                   RowBox[{"hour", "+", "1"}], "]"}], "]"}], "=", 
                 RowBox[{
                  RowBox[{"saveC", "[", 
                   RowBox[{"[", "hour", "]"}], "]"}], "+", 
                  RowBox[{"Min", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"dataCproducelight", "[", 
                    RowBox[{"[", "hour", "]"}], "]"}], "+", 
                    RowBox[{"dataCproducewind", "[", 
                    RowBox[{"[", "hour", "]"}], "]"}], "-", 
                    RowBox[{"dataCneed", "[", 
                    RowBox[{"[", "hour", "]"}], "]"}]}], ")"}], ",", 
                    "power"}], "}"}], "]"}]}]}]}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"dataCproducelight", "[", 
                 RowBox[{"[", "hour", "]"}], "]"}], "<=", 
                RowBox[{"dataCneed", "[", 
                 RowBox[{"[", "hour", "]"}], "]"}], "<", 
                RowBox[{
                 RowBox[{"dataCproducelight", "[", 
                  RowBox[{"[", "hour", "]"}], "]"}], "+", 
                 RowBox[{"dataCproducewind", "[", 
                  RowBox[{"[", "hour", "]"}], "]"}]}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"ebuylightC", "[", 
                  RowBox[{"[", "hour", "]"}], "]"}], "=", 
                 RowBox[{"dataCproducelight", "[", 
                  RowBox[{"[", "hour", "]"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"ebuywindC", "[", 
                  RowBox[{"[", "hour", "]"}], "]"}], "=", 
                 RowBox[{
                  RowBox[{"dataCneed", "[", 
                   RowBox[{"[", "hour", "]"}], "]"}], "-", 
                  RowBox[{"dataCproducelight", "[", 
                   RowBox[{"[", "hour", "]"}], "]"}]}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"ebuynetC", "[", 
                  RowBox[{"[", "hour", "]"}], "]"}], "=", "0"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"wasteC", "[", 
                  RowBox[{"[", "hour", "]"}], "]"}], "=", 
                 RowBox[{
                  RowBox[{"dataCproducelight", "[", 
                   RowBox[{"[", "hour", "]"}], "]"}], "+", 
                  RowBox[{"dataCproducewind", "[", 
                   RowBox[{"[", "hour", "]"}], "]"}], "-", 
                  RowBox[{"dataCneed", "[", 
                   RowBox[{"[", "hour", "]"}], "]"}], "-", 
                  RowBox[{"Min", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"dataCproducelight", "[", 
                    RowBox[{"[", "hour", "]"}], "]"}], "+", 
                    RowBox[{"dataCproducewind", "[", 
                    RowBox[{"[", "hour", "]"}], "]"}], "-", 
                    RowBox[{"dataCneed", "[", 
                    RowBox[{"[", "hour", "]"}], "]"}]}], ")"}], ",", 
                    "power"}], "}"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"moneyC", "[", 
                  RowBox[{"[", "hour", "]"}], "]"}], "=", 
                 RowBox[{
                  RowBox[{"0.4", "*", 
                   RowBox[{"ebuylightC", "[", 
                    RowBox[{"[", "hour", "]"}], "]"}]}], "+", 
                  RowBox[{"0.5", "*", 
                   RowBox[{"ebuywindC", "[", 
                    RowBox[{"[", "hour", "]"}], "]"}]}], "+", 
                  RowBox[{"1", "*", 
                   RowBox[{"ebuynetC", "[", 
                    RowBox[{"[", "hour", "]"}], "]"}]}]}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"saveC", "[", 
                  RowBox[{"[", 
                   RowBox[{"hour", "+", "1"}], "]"}], "]"}], "=", 
                 RowBox[{
                  RowBox[{"saveC", "[", 
                   RowBox[{"[", "hour", "]"}], "]"}], "+", 
                  RowBox[{"Min", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"dataCproducelight", "[", 
                    RowBox[{"[", "hour", "]"}], "]"}], "+", 
                    RowBox[{"dataCproducewind", "[", 
                    RowBox[{"[", "hour", "]"}], "]"}], "-", 
                    RowBox[{"dataCneed", "[", 
                    RowBox[{"[", "hour", "]"}], "]"}]}], ")"}], ",", 
                    "power"}], "}"}], "]"}]}]}]}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"dataCproducelight", "[", 
                  RowBox[{"[", "hour", "]"}], "]"}], "+", 
                 RowBox[{"dataCproducewind", "[", 
                  RowBox[{"[", "hour", "]"}], "]"}]}], "<=", 
                RowBox[{"dataCneed", "[", 
                 RowBox[{"[", "hour", "]"}], "]"}], "<", 
                RowBox[{
                 RowBox[{"dataCproducelight", "[", 
                  RowBox[{"[", "hour", "]"}], "]"}], "+", 
                 RowBox[{"dataCproducewind", "[", 
                  RowBox[{"[", "hour", "]"}], "]"}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"saveC", "[", 
                    RowBox[{"[", "hour", "]"}], "]"}], "-", 
                    RowBox[{"energy", "*", "0.1"}]}], ")"}], "*", 
                  "0.95"}]}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"ebuylightC", "[", 
                  RowBox[{"[", "hour", "]"}], "]"}], "=", 
                 RowBox[{"dataCproducelight", "[", 
                  RowBox[{"[", "hour", "]"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"ebuywindC", "[", 
                  RowBox[{"[", "hour", "]"}], "]"}], "=", 
                 RowBox[{"dataCproducewind", "[", 
                  RowBox[{"[", "hour", "]"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"ebuynetC", "[", 
                  RowBox[{"[", "hour", "]"}], "]"}], "=", "0"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"wasteC", "[", 
                  RowBox[{"[", "hour", "]"}], "]"}], "=", "0"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"moneyC", "[", 
                  RowBox[{"[", "hour", "]"}], "]"}], "=", 
                 RowBox[{
                  RowBox[{"0.4", "*", 
                   RowBox[{"ebuylightC", "[", 
                    RowBox[{"[", "hour", "]"}], "]"}]}], "+", 
                  RowBox[{"0.5", "*", 
                   RowBox[{"ebuywindC", "[", 
                    RowBox[{"[", "hour", "]"}], "]"}]}], "+", 
                  RowBox[{"1", "*", 
                   RowBox[{"ebuynetC", "[", 
                    RowBox[{"[", "hour", "]"}], "]"}]}]}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"saveC", "[", 
                  RowBox[{"[", 
                   RowBox[{"hour", "+", "1"}], "]"}], "]"}], "=", 
                 RowBox[{
                  RowBox[{"saveC", "[", 
                   RowBox[{"[", "hour", "]"}], "]"}], "-", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"dataCneed", "[", 
                    RowBox[{"[", "hour", "]"}], "]"}], "-", 
                    RowBox[{"dataCproducelight", "[", 
                    RowBox[{"[", "hour", "]"}], "]"}], "-", 
                    RowBox[{"dataCproducewind", "[", 
                    RowBox[{"[", "hour", "]"}], "]"}]}], ")"}], "/", 
                   "0.95"}]}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"dataCneed", "[", 
                 RowBox[{"[", "hour", "]"}], "]"}], ">=", 
                RowBox[{
                 RowBox[{"dataCproducelight", "[", 
                  RowBox[{"[", "hour", "]"}], "]"}], "+", 
                 RowBox[{"dataCproducewind", "[", 
                  RowBox[{"[", "hour", "]"}], "]"}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"saveC", "[", 
                    RowBox[{"[", "hour", "]"}], "]"}], "-", 
                    RowBox[{"energy", "*", "0.1"}]}], ")"}], "*", 
                  "0.95"}]}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"ebuylightC", "[", 
                  RowBox[{"[", "hour", "]"}], "]"}], "=", 
                 RowBox[{"dataCproducelight", "[", 
                  RowBox[{"[", "hour", "]"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"ebuywindC", "[", 
                  RowBox[{"[", "hour", "]"}], "]"}], "=", 
                 RowBox[{"dataCproducewind", "[", 
                  RowBox[{"[", "hour", "]"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"ebuynetC", "[", 
                  RowBox[{"[", "hour", "]"}], "]"}], "=", 
                 RowBox[{
                  RowBox[{"dataCneed", "[", 
                   RowBox[{"[", "hour", "]"}], "]"}], "-", 
                  RowBox[{"dataCproducelight", "[", 
                   RowBox[{"[", "hour", "]"}], "]"}], "-", 
                  RowBox[{"dataCproducewind", "[", 
                   RowBox[{"[", "hour", "]"}], "]"}], "-", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"saveC", "[", 
                    RowBox[{"[", "hour", "]"}], "]"}], "-", 
                    RowBox[{"energy", "*", "0.1"}]}], ")"}], "*", 
                   "0.95"}]}]}], ";", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"wasteC", "[", 
                  RowBox[{"[", "hour", "]"}], "]"}], "=", "0"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"moneyC", "[", 
                  RowBox[{"[", "hour", "]"}], "]"}], "=", 
                 RowBox[{
                  RowBox[{"0.4", "*", 
                   RowBox[{"ebuylightC", "[", 
                    RowBox[{"[", "hour", "]"}], "]"}]}], "+", 
                  RowBox[{"0.5", "*", 
                   RowBox[{"ebuywindC", "[", 
                    RowBox[{"[", "hour", "]"}], "]"}]}], "+", 
                  RowBox[{"1", "*", 
                   RowBox[{"ebuynetC", "[", 
                    RowBox[{"[", "hour", "]"}], "]"}]}]}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"saveC", "[", 
                  RowBox[{"[", 
                   RowBox[{"hour", "+", "1"}], "]"}], "]"}], "=", 
                 RowBox[{"energy", "*", "0.1"}]}]}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"saveC", "[", 
                 RowBox[{"[", 
                  RowBox[{"hour", "+", "1"}], "]"}], "]"}], ">", 
                RowBox[{"energy", "*", "0.9"}]}], ",", 
               RowBox[{
                RowBox[{"saveC", "[", 
                 RowBox[{"[", 
                  RowBox[{"hour", "+", "1"}], "]"}], "]"}], "=", 
                RowBox[{"energy", "*", "0.9"}]}]}], "]"}], ";"}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"hour", ",", "1", ",", "24"}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"daypriceC", "[", 
            RowBox[{"[", "day", "]"}], "]"}], "=", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"moneyC", "[", 
              RowBox[{"[", "hour", "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"hour", ",", "1", ",", "24"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"saveC", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "=", 
           RowBox[{"saveC", "[", 
            RowBox[{"[", "25", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
         ",", 
         RowBox[{"{", 
          RowBox[{"day", ",", "1", ",", "1825"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
       "(*", "C\:5730\:4e94\:5e74\:8d2d\:7535\:603b\:6210\:672c", "*)"}], 
       RowBox[{"sumpriceC", "=", 
        RowBox[{"N", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"daypriceC", "[", 
              RowBox[{"[", "day", "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"day", ",", "1", ",", "1825"}], "}"}]}], "]"}], "+", 
           RowBox[{"800", "*", "power"}], "+", 
           RowBox[{"1800", "*", "energy"}], "+", 
           RowBox[{"2500", "*", "pv"}], "+", 
           RowBox[{"3000", "*", "pw"}]}], ",", "16"}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.925546379626629*^9, 3.925546424274025*^9}, {
   3.925546462474537*^9, 3.925546523886749*^9}, {3.925547021264038*^9, 
   3.925547022499193*^9}, {3.925547231194631*^9, 3.9255472319746113`*^9}, {
   3.9255479662407303`*^9, 3.9255479682428226`*^9}, {3.925548316825964*^9, 
   3.925548317476185*^9}, {3.925548496248872*^9, 3.925548500463852*^9}, {
   3.925548749353708*^9, 3.925548752472151*^9}, {3.925548846596615*^9, 
   3.925548848862692*^9}, {3.9255490265239964`*^9, 3.9255490340279827`*^9}, {
   3.9255514314566536`*^9, 3.9255514740045757`*^9}, {3.925551506336798*^9, 
   3.925551510869419*^9}, {3.925553501245318*^9, 3.925553531353609*^9}, {
   3.92555366317468*^9, 3.9255536644352264`*^9}, {3.925553709618667*^9, 
   3.925553762566099*^9}, {3.925587776885589*^9, 3.925587821806982*^9}, 
   3.9255894071846066`*^9, {3.925591240683975*^9, 3.925591244032122*^9}, {
   3.925591384026484*^9, 3.925591387211731*^9}, {3.925591614672934*^9, 
   3.925591790779505*^9}, {3.925591840431196*^9, 3.925591985330082*^9}, {
   3.9255920198621635`*^9, 3.925592041276238*^9}, 3.925592102742399*^9, {
   3.925592147909476*^9, 3.925592172337641*^9}, {3.925592250536743*^9, 
   3.925592262585039*^9}, 3.925592297839354*^9, {3.925592401067929*^9, 
   3.925592413898157*^9}, {3.925592933507189*^9, 3.92559302901*^9}, {
   3.925593880144177*^9, 3.925593886533213*^9}, {3.925594896141098*^9, 
   3.92559490753316*^9}, {3.925594994337925*^9, 3.9255950068597984`*^9}, {
   3.9255951828008595`*^9, 3.925595185007952*^9}, {3.9255954079673996`*^9, 
   3.925595410483143*^9}, {3.925595605939264*^9, 3.925595611432099*^9}, {
   3.925595645999943*^9, 3.925595652359543*^9}, {3.9255956972072983`*^9, 
   3.925595791042599*^9}, {3.9255958877138977`*^9, 3.925595897522236*^9}, 
   3.9255959468761272`*^9, {3.9255959782277536`*^9, 3.9255959815664215`*^9}, {
   3.925596018235041*^9, 3.92559621496991*^9}, {3.925596254828467*^9, 
   3.9255962856269855`*^9}, {3.9255963910145226`*^9, 
   3.9255965930384083`*^9}, {3.9255966316562653`*^9, 
   3.9255967595826416`*^9}, {3.925596796819788*^9, 3.925596983452553*^9}, {
   3.925597048787066*^9, 3.925597090267538*^9}, {3.925597285954542*^9, 
   3.925597291702275*^9}, {3.925599942538265*^9, 3.925599988731777*^9}, {
   3.9256000749711704`*^9, 3.925600161297499*^9}, {3.925600586511158*^9, 
   3.925600588235073*^9}, {3.925607148368105*^9, 3.9256071823465385`*^9}, {
   3.925610426304418*^9, 3.925610843468588*^9}, {3.9256111913586197`*^9, 
   3.925611193988628*^9}, {3.925611746130974*^9, 3.9256118054545918`*^9}, {
   3.925611841134533*^9, 3.925611974834287*^9}, {3.925612045642294*^9, 
   3.925612046728489*^9}, {3.9256120770019608`*^9, 3.925612115298937*^9}, {
   3.9256121652993164`*^9, 3.925612255452399*^9}, {3.925612347253371*^9, 
   3.925612513071747*^9}, {3.925612566478189*^9, 3.925612915961401*^9}, {
   3.925801023413053*^9, 3.925801025125519*^9}, {3.925801110498705*^9, 
   3.925801125730905*^9}, {3.925801170291548*^9, 3.9258012038841305`*^9}, {
   3.9258012363486*^9, 3.9258013394115734`*^9}, {3.9258014652261868`*^9, 
   3.925801466156451*^9}, {3.9258032730949574`*^9, 3.925803274842605*^9}, {
   3.928102165590835*^9, 3.928102184418951*^9}, {3.928102239178886*^9, 
   3.9281022558172855`*^9}, {3.928102296118698*^9, 3.9281023217494545`*^9}, {
   3.928102724800249*^9, 3.928102746385828*^9}, 3.9281028139367657`*^9, {
   3.9281029575734005`*^9, 3.928102959905115*^9}, {3.928111966764138*^9, 
   3.928112045217556*^9}, {3.9281121661024895`*^9, 3.928112166335488*^9}, {
   3.928405714627704*^9, 3.928405716682448*^9}, {3.928406635295828*^9, 
   3.928406639444353*^9}, {3.929165490674991*^9, 3.929165500877556*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"a6e4f463-ccc2-d647-a8ba-3b4b05123d62"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\:79cd\:7fa4\:6570\:91cf", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"pop", "=", "30"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "\:53d8\:91cf\:7ef4\:6570", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dim", "=", "4"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "\:4e0a\:8fb9\:754c\:4fe1\:606f", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ub", "=", 
     RowBox[{"{", 
      RowBox[{"1000", ",", "1800", ",", "1500", ",", "2000"}], "}"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"(*", "\:4e0b\:8fb9\:754c\:4fe1\:606f", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lb", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "\:79c3\:9e70\:9009\:62e9\:9636\:6bb5\:641c\:7d22\:8303\:56f4", "\:ff0c", 
     "\:767e\:5206\:6bd4\:503c"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"searchRange", "=", "0.03"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "\:6700\:5927\:8fed\:4ee3\:6b21\:6570", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"maxiter", "=", "10"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
   "(*", "\:5c06\:4e3b\:51fd\:6570\:4e0e\:9002\:5e94\:5ea6\:51fd\:6570\:8fde\
\:63a5", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fobj", "=", "findminC"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "\:6c42\:89e3\:6700\:4f18\:4e2a\:4f53\:4fe1\:606f", "\:ff0c", 
     "\:6700\:4f18\:503c", "\:ff0c", 
     "\:6700\:4f18\:503c\:8fed\:4ee3\:5386\:53f2\:8bb0\:5f55", "\:ff0c", 
     "\:8ba1\:7b97\:65f6\:540c\:6b65\:663e\:793a\:8fed\:4ee3\:6b21\:6570"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"bestpos", ",", "bestfitness", ",", "itercurve"}], "}"}], "=", 
      RowBox[{"BES", "[", 
       RowBox[{
       "pop", ",", "dim", ",", "ub", ",", "lb", ",", "fobj", ",", "maxiter"}],
        "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"bestpos", ",", "bestfitness", ",", "t"}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9292437656317005`*^9, 3.929243802581049*^9}, {
   3.929243858489477*^9, 3.929243859293098*^9}, {3.929245269819509*^9, 
   3.9292452788828926`*^9}, {3.929246225435281*^9, 3.929246226111866*^9}, {
   3.9292469464510574`*^9, 3.9292469464776974`*^9}, {3.929247481952776*^9, 
   3.929247482124439*^9}, {3.929247686797325*^9, 3.9292476872853546`*^9}, {
   3.929255432861759*^9, 3.929255432958525*^9}, 3.929257376954199*^9, {
   3.92925812530682*^9, 3.929258138130426*^9}, {3.9292592690393257`*^9, 
   3.9292592745614166`*^9}, {3.929325177169306*^9, 3.929325185965315*^9}, {
   3.929328598385969*^9, 3.929328614254486*^9}, {3.9293290859578857`*^9, 
   3.929329135798305*^9}, {3.9293293245567303`*^9, 3.929329342788*^9}, 
   3.929329423551082*^9, {3.929330003056448*^9, 3.929330003553797*^9}, {
   3.929331061115444*^9, 3.929331061500057*^9}, {3.929331338992461*^9, 
   3.9293313398215294`*^9}, {3.929331744862961*^9, 3.929331749001902*^9}, {
   3.929340082851614*^9, 3.929340088274037*^9}, {3.9293401898774033`*^9, 
   3.9293401927244186`*^9}, {3.929340415410116*^9, 3.929340418339607*^9}, {
   3.929342568537222*^9, 3.9293426059178143`*^9}, {3.929342664321188*^9, 
   3.929342777785509*^9}, {3.9293428095352364`*^9, 3.92934280998814*^9}, 
   3.929343401643081*^9, {3.9294129787471447`*^9, 3.929413003414461*^9}, 
   3.92941388942041*^9, {3.929421476921358*^9, 3.929421524552656*^9}, {
   3.9294216110807457`*^9, 3.929421611396652*^9}, {3.9294220354169235`*^9, 
   3.9294220355442524`*^9}, 3.92942216095331*^9, {3.9294224273634224`*^9, 
   3.929422429671072*^9}, {3.929426589193472*^9, 3.929426603926561*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"67d3d93f-c9ef-9f40-ac08-44911afcc247"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "258.7388542365048`", ",", "501.67754376939456`", ",", 
     "359.6740259736336`", ",", "1792.6307682362606`"}], "}"}], ",", 
   "1.6771477749855936`*^7", ",", 
   RowBox[{"{", 
    RowBox[{
    "1.6942060078743473`*^7", ",", "1.6804655856846627`*^7", ",", 
     "1.678935635859994`*^7", ",", "1.678935635859994`*^7", ",", 
     "1.6778912644864965`*^7", ",", "1.6778912644864965`*^7", ",", 
     "1.6771477749855936`*^7", ",", "1.6771477749855936`*^7", ",", 
     "1.6771477749855936`*^7", ",", "1.6771477749855936`*^7"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.929413085541033*^9, 3.929413410069038*^9, 3.929413542461369*^9, 
   3.9294138869678097`*^9, 3.9294143364471607`*^9, 3.929414384377383*^9, 
   3.929414492563644*^9, 3.929414925833669*^9, 3.929415161752285*^9, 
   3.929415536852981*^9, 3.929416064859473*^9, 3.929417707562948*^9, 
   3.92941841671994*^9, 3.929418945471958*^9, 3.92941969537622*^9, 
   3.929420022642967*^9, 3.929420561567457*^9, 3.929421166388912*^9, {
   3.929422032410179*^9, 3.929422046624499*^9}, 3.929422156541069*^9, 
   3.929422421777588*^9, 3.929426601623972*^9, 3.929427023325269*^9, 
   3.929595078093811*^9, 3.9295960550756245`*^9, 3.9301299627930775`*^9},
 CellLabel->"Out[55]=",ExpressionUUID->"349a86c6-3135-ec44-9c5c-9559230f2d67"]
}, Open  ]]
},
WindowSize->{1269, 721},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"14.0 for Microsoft Windows (64-bit) (2023\:5e7412\:670812\
\:65e5)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"9a0161f3-7da5-7f4b-98aa-95af124ec818"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 218, 3, 43, "Input",ExpressionUUID->"7096a7b1-5235-6346-b3f9-6bae6010e095"],
Cell[779, 25, 1717, 43, 156, "Input",ExpressionUUID->"b1a89bed-3815-1248-b9d2-b152b600caad"],
Cell[2499, 70, 2064, 51, 243, "Input",ExpressionUUID->"b0ed6135-d962-084c-a27b-3ffa03db796c"],
Cell[4566, 123, 18066, 428, 1843, "Input",ExpressionUUID->"f980bcba-8dbd-544d-9439-fd651664fb40"],
Cell[22635, 553, 3691, 96, 287, "Input",ExpressionUUID->"2735c565-00ce-4149-8a2f-972ce4c55af6"],
Cell[26329, 651, 22323, 480, 1221, "Input",ExpressionUUID->"a6e4f463-ccc2-d647-a8ba-3b4b05123d62"],
Cell[CellGroupData[{
Cell[48677, 1135, 3907, 79, 328, "Input",ExpressionUUID->"67d3d93f-c9ef-9f40-ac08-44911afcc247"],
Cell[52587, 1216, 1363, 26, 57, "Output",ExpressionUUID->"349a86c6-3135-ec44-9c5c-9559230f2d67"]
}, Open  ]]
}
]
*)

