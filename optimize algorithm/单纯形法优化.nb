(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 14.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     43754,       1019]
NotebookOptionsPosition[     42730,        994]
NotebookOutlinePosition[     43192,       1013]
CellTagsIndexPosition[     43149,       1010]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.925522917398569*^9, 3.925522924544531*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"3f9b2d5e-c37c-4848-830c-4133de73b95b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dataneed", "=", 
   RowBox[{"Part", "[", 
    RowBox[{
     RowBox[{
     "Import", "@", 
      "\"\<C:\\\\Users\\\\PC\\\\Desktop\\\\\:7535\:5de5\:676f\\\\\:8d5b\:9898\
\:4ee5\:53ca\:6570\:636eA\\\\\:9644\:4ef61\:ff1a\:5404\:56ed\:533a\:5178\:578b\
\:65e5\:8d1f\:8377\:6570\:636e.csv\>\""}], ",", 
     RowBox[{"2", ";;"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", "A\:5730\:8d1f\:8377", "*)"}], 
  RowBox[{
   RowBox[{"dataAneed", "=", 
    RowBox[{"1.5", "*", 
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"#2", "&"}], "@@@", "dataneed"}], ",", 
       RowBox[{"-", "2"}]}], "]"}]}]}], ";"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", "B\:5730\:8d1f\:8377", "*)"}], 
  RowBox[{
   RowBox[{"dataBneed", "=", 
    RowBox[{"1.5", "*", 
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"#3", "&"}], "@@@", "dataneed"}], ",", 
       RowBox[{"-", "2"}]}], "]"}]}]}], ";"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", "C\:5730\:8d1f\:8377", "*)"}], 
  RowBox[{
   RowBox[{"dataCneed", "=", 
    RowBox[{"1.5", "*", 
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"#4", "&"}], "@@@", "dataneed"}], ",", 
       RowBox[{"-", "2"}]}], "]"}]}]}], ";"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dataproduce", "=", 
   RowBox[{"Part", "[", 
    RowBox[{
     RowBox[{
     "Import", "@", 
      "\"\<C:\\\\Users\\\\PC\\\\Desktop\\\\\:7535\:5de5\:676f\\\\\:8d5b\:9898\
\:4ee5\:53ca\:6570\:636eA\\\\\:9644\:4ef62\:ff1a\:5404\:56ed\:533a\:5178\:578b\
\:65e5\:98ce\:5149\:53d1\:7535\:6570\:636e.csv\>\""}], ",", 
     RowBox[{"4", ";;"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", "A\:5730\:53d1\:7535\:91cf", "*)"}], 
  RowBox[{
   RowBox[{"dataAproduce", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"750", "*", "#2"}], "&"}], "@@@", "dataproduce"}]}], 
   ";"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", "B\:5730\:53d1\:7535\:91cf", "*)"}], 
  RowBox[{
   RowBox[{"dataBproduce", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"1000", "*", "#3"}], "&"}], "@@@", "dataproduce"}]}], 
   ";"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", "C\:5730\:5149\:80fd\:53d1\:7535\:91cf", "*)"}], 
  RowBox[{
   RowBox[{"dataCproducelight", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"600", "*", "#4"}], "&"}], "@@@", "dataproduce"}]}], 
   ";"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", "C\:5730\:98ce\:80fd\:53d1\:7535\:91cf", "*)"}], 
  RowBox[{
   RowBox[{"dataCproducewind", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"500", "*", "#5"}], "&"}], "@@@", "dataproduce"}]}], 
   ";"}]}]}], "Input",
 CellChangeTimes->{{3.925500640418431*^9, 3.925500687883127*^9}, {
   3.9255007200110836`*^9, 3.9255007324855556`*^9}, {3.92550080687702*^9, 
   3.925500921772743*^9}, {3.9255009651834984`*^9, 3.925500973093704*^9}, {
   3.925501077828671*^9, 3.925501341734343*^9}, {3.925501406292801*^9, 
   3.925501413729858*^9}, {3.925501592276985*^9, 3.925501596439934*^9}, {
   3.925522771523419*^9, 3.925522775184379*^9}, {3.9255228988146152`*^9, 
   3.925522900913463*^9}, 3.925522948651696*^9, {3.925525287721756*^9, 
   3.925525360071596*^9}, {3.925527367749527*^9, 3.925527413176628*^9}, 
   3.925532306356339*^9, 3.925542487855831*^9, 3.9255893951316223`*^9, {
   3.925698484389843*^9, 3.925698533555786*^9}, {3.925700681814081*^9, 
   3.925700685362477*^9}, {3.925797852133198*^9, 3.92579785380249*^9}, {
   3.925798110194067*^9, 3.92579811052841*^9}, {3.925799215443903*^9, 
   3.925799222317217*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"73e65a17-31ee-f64f-b155-ee8f52f04c2c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"moneyA", "=", 
   RowBox[{"ebuynetA", "=", 
    RowBox[{"ebuywindA", "=", 
     RowBox[{"ebuylightA", "=", 
      RowBox[{"wasteA", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"i", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "24"}], "}"}]}], "]"}]}]}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"daypriceA", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"i", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1825"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"saveA", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"i", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "25"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"findminA", "[", 
   RowBox[{
    RowBox[{"power_", "?", "NumericQ"}], ",", 
    RowBox[{"energy_", "?", "NumericQ"}], ",", 
    RowBox[{"pv_", "?", "NumericQ"}]}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{"(*", "A\:5730\:53d1\:7535\:91cf", "*)"}], 
   RowBox[{
    RowBox[{"dataAproduce", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"pv", "*", "#2"}], "&"}], "@@@", "dataproduce"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"saveA", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "=", 
     RowBox[{"energy", "*", "0.1"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\n", 
     RowBox[{
      RowBox[{
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"dataAneed", "[", 
              RowBox[{"[", "hour", "]"}], "]"}], "<", 
             RowBox[{"dataAproduce", "[", 
              RowBox[{"[", "hour", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"ebuylightA", "[", 
               RowBox[{"[", "hour", "]"}], "]"}], "=", 
              RowBox[{"dataAneed", "[", 
               RowBox[{"[", "hour", "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ebuynetA", "[", 
               RowBox[{"[", "hour", "]"}], "]"}], "=", "0"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"wasteA", "[", 
               RowBox[{"[", "hour", "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"dataAproduce", "[", 
                RowBox[{"[", "hour", "]"}], "]"}], "-", 
               RowBox[{"dataAneed", "[", 
                RowBox[{"[", "hour", "]"}], "]"}], "-", 
               RowBox[{"Min", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"dataAproduce", "[", 
                    RowBox[{"[", "hour", "]"}], "]"}], "-", 
                   RowBox[{"dataAneed", "[", 
                    RowBox[{"[", "hour", "]"}], "]"}]}], ",", "power"}], 
                 "}"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"moneyA", "[", 
               RowBox[{"[", "hour", "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"0.4", "*", 
                RowBox[{"ebuylightA", "[", 
                 RowBox[{"[", "hour", "]"}], "]"}]}], "+", 
               RowBox[{"1", "*", 
                RowBox[{"ebuynetA", "[", 
                 RowBox[{"[", "hour", "]"}], "]"}]}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"saveA", "[", 
               RowBox[{"[", 
                RowBox[{"hour", "+", "1"}], "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"saveA", "[", 
                RowBox[{"[", "hour", "]"}], "]"}], "+", 
               RowBox[{"Min", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"dataAproduce", "[", 
                    RowBox[{"[", "hour", "]"}], "]"}], "-", 
                   RowBox[{"dataAneed", "[", 
                    RowBox[{"[", "hour", "]"}], "]"}]}], ",", "power"}], 
                 "}"}], "]"}]}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"dataAproduce", "[", 
              RowBox[{"[", "hour", "]"}], "]"}], "<=", 
             RowBox[{"dataAneed", "[", 
              RowBox[{"[", "hour", "]"}], "]"}], "<", 
             RowBox[{
              RowBox[{"dataAproduce", "[", 
               RowBox[{"[", "hour", "]"}], "]"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"saveA", "[", 
                  RowBox[{"[", "hour", "]"}], "]"}], "-", 
                 RowBox[{"energy", "*", "0.1"}]}], ")"}], "*", "0.95"}]}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"ebuylightA", "[", 
               RowBox[{"[", "hour", "]"}], "]"}], "=", 
              RowBox[{"dataAproduce", "[", 
               RowBox[{"[", "hour", "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ebuynetA", "[", 
               RowBox[{"[", "hour", "]"}], "]"}], "=", "0"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"wasteA", "[", 
               RowBox[{"[", "hour", "]"}], "]"}], "=", "0"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"moneyA", "[", 
               RowBox[{"[", "hour", "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"0.4", "*", 
                RowBox[{"ebuylightA", "[", 
                 RowBox[{"[", "hour", "]"}], "]"}]}], "+", 
               RowBox[{"1", "*", 
                RowBox[{"ebuynetA", "[", 
                 RowBox[{"[", "hour", "]"}], "]"}]}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"saveA", "[", 
               RowBox[{"[", 
                RowBox[{"hour", "+", "1"}], "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"saveA", "[", 
                RowBox[{"[", "hour", "]"}], "]"}], "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"dataAneed", "[", 
                   RowBox[{"[", "hour", "]"}], "]"}], "-", 
                  RowBox[{"dataAproduce", "[", 
                   RowBox[{"[", "hour", "]"}], "]"}]}], ")"}], "/", 
                "0.95"}]}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"dataAneed", "[", 
              RowBox[{"[", "hour", "]"}], "]"}], ">=", 
             RowBox[{
              RowBox[{"dataAproduce", "[", 
               RowBox[{"[", "hour", "]"}], "]"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"saveA", "[", 
                  RowBox[{"[", "hour", "]"}], "]"}], "-", 
                 RowBox[{"energy", "*", "0.1"}]}], ")"}], "*", "0.95"}]}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"ebuylightA", "[", 
               RowBox[{"[", "hour", "]"}], "]"}], "=", 
              RowBox[{"dataAproduce", "[", 
               RowBox[{"[", "hour", "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ebuynetA", "[", 
               RowBox[{"[", "hour", "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"dataAneed", "[", 
                RowBox[{"[", "hour", "]"}], "]"}], "-", 
               RowBox[{"dataAproduce", "[", 
                RowBox[{"[", "hour", "]"}], "]"}], "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"saveA", "[", 
                   RowBox[{"[", "hour", "]"}], "]"}], "-", 
                  RowBox[{"energy", "*", "0.1"}]}], ")"}], "*", "0.95"}]}]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"wasteA", "[", 
               RowBox[{"[", "hour", "]"}], "]"}], "=", "0"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"moneyA", "[", 
               RowBox[{"[", "hour", "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"0.4", "*", 
                RowBox[{"ebuylightA", "[", 
                 RowBox[{"[", "hour", "]"}], "]"}]}], "+", 
               RowBox[{"1", "*", 
                RowBox[{"ebuynetA", "[", 
                 RowBox[{"[", "hour", "]"}], "]"}]}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"saveA", "[", 
               RowBox[{"[", 
                RowBox[{"hour", "+", "1"}], "]"}], "]"}], "=", 
              RowBox[{"energy", "*", "0.1"}]}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"saveA", "[", 
              RowBox[{"[", 
               RowBox[{"hour", "+", "1"}], "]"}], "]"}], ">", 
             RowBox[{"energy", "*", "0.9"}]}], ",", 
            RowBox[{
             RowBox[{"saveA", "[", 
              RowBox[{"[", 
               RowBox[{"hour", "+", "1"}], "]"}], "]"}], "=", 
             RowBox[{"energy", "*", "0.9"}]}]}], "]"}], ";"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"hour", ",", "1", ",", "24"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"daypriceA", "[", 
         RowBox[{"[", "day", "]"}], "]"}], "=", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"moneyA", "[", 
           RowBox[{"[", "hour", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"hour", ",", "1", ",", "24"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"saveA", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", 
        RowBox[{"saveA", "[", 
         RowBox[{"[", "25", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"day", ",", "1", ",", "1825"}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", "A\:5730\:4e94\:5e74\:8d2d\:7535\:603b\:6210\:672c", "*)"}], 
    RowBox[{"sumpriceA", "=", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"daypriceA", "[", 
         RowBox[{"[", "day", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"day", ",", "1", ",", "1825"}], "}"}]}], "]"}], "+", 
      RowBox[{"800", "*", "power"}], "+", 
      RowBox[{"1800", "*", "energy"}], "+", 
      RowBox[{"2500", "*", "pv"}]}]}]}], ")"}]}]}], "Input",
 CellChangeTimes->{{3.925546379626629*^9, 3.925546424274025*^9}, {
   3.925546462474537*^9, 3.925546523886749*^9}, {3.925547021264038*^9, 
   3.925547022499193*^9}, {3.925547231194631*^9, 3.9255472319746113`*^9}, {
   3.9255479662407303`*^9, 3.9255479682428226`*^9}, {3.925548316825964*^9, 
   3.925548317476185*^9}, {3.925548496248872*^9, 3.925548500463852*^9}, {
   3.925548749353708*^9, 3.925548752472151*^9}, {3.925548846596615*^9, 
   3.925548848862692*^9}, {3.9255490265239964`*^9, 3.9255490340279827`*^9}, {
   3.9255514314566536`*^9, 3.9255514740045757`*^9}, {3.925551506336798*^9, 
   3.925551510869419*^9}, {3.925553501245318*^9, 3.925553531353609*^9}, {
   3.92555366317468*^9, 3.9255536644352264`*^9}, {3.925553709618667*^9, 
   3.925553762566099*^9}, {3.925587776885589*^9, 3.925587821806982*^9}, {
   3.9255879714630604`*^9, 3.925588012940111*^9}, {3.9255882077484856`*^9, 
   3.925588226253872*^9}, {3.925588626866129*^9, 3.925588629937187*^9}, {
   3.925588673503374*^9, 3.925588747673834*^9}, {3.9255887844621353`*^9, 
   3.92558881197394*^9}, {3.925588971526539*^9, 3.92558898478972*^9}, {
   3.9255891494894753`*^9, 3.9255891561439705`*^9}, {3.925589187000307*^9, 
   3.925589215114744*^9}, {3.925589246333565*^9, 3.925589274961743*^9}, {
   3.925589432758335*^9, 3.925589437695618*^9}, {3.925593180516838*^9, 
   3.9255931925761604`*^9}, {3.925593396538807*^9, 3.925593516978497*^9}, {
   3.92559354784939*^9, 3.925593623631483*^9}, {3.925602901901428*^9, 
   3.9256029518559704`*^9}, 3.925605885463186*^9, {3.92560607403446*^9, 
   3.925606081529394*^9}, {3.925606838814069*^9, 3.9256069121322823`*^9}, {
   3.925606958300333*^9, 3.92560702184671*^9}, {3.925607643657057*^9, 
   3.92560765025992*^9}, {3.925702600498754*^9, 3.925702601153206*^9}, {
   3.925702729972557*^9, 3.9257029568929996`*^9}, 3.9257033123161755`*^9, {
   3.925712686594145*^9, 3.9257128691918526`*^9}, 3.925762824616316*^9, {
   3.9257628805104065`*^9, 3.925762993136322*^9}, {3.92576348043351*^9, 
   3.925763497697283*^9}, {3.92576401496322*^9, 3.925764016919407*^9}, {
   3.925764526713701*^9, 3.925764544634814*^9}, {3.925765215537537*^9, 
   3.9257652158927135`*^9}, {3.9257664768465557`*^9, 3.925766488504684*^9}, {
   3.925797865777399*^9, 3.9257978673577194`*^9}, {3.925797987920326*^9, 
   3.925798002225159*^9}, {3.9257980526329136`*^9, 3.925798058661808*^9}, {
   3.925799387164585*^9, 3.925799409620537*^9}, {3.925801034229519*^9, 
   3.925801034846342*^9}, 3.925801161103189*^9},
 CellLabel->"In[11]:=",ExpressionUUID->"c738b972-614a-d147-8d27-9f18973eff8e"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Monitor", "[", 
   RowBox[{
    RowBox[{"NMinimize", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"findminA", "[", 
         RowBox[{"power", ",", "energy", ",", "pv"}], "]"}], ",", 
        RowBox[{
         RowBox[{"0", "<=", "power", "<=", "1000"}], "&&", 
         RowBox[{"0", "<=", "energy", "<=", "1800"}], "&&", 
         RowBox[{"0", "<=", "pv", "<=", "1500"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"power", ",", "energy", ",", "pv"}], "}"}], ",", 
      RowBox[{"Method", "->", 
       RowBox[{"{", 
        RowBox[{"\"\<NelderMead\>\"", ",", 
         RowBox[{"\"\<RandomSeed\>\"", "->", "100"}]}], "}"}]}], ",", 
      RowBox[{"WorkingPrecision", "->", "4"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"power", ",", "energy", ",", "pv"}], "}"}]}], "]"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.925763018507115*^9, 3.9257630261305313`*^9}, {
   3.925764659375625*^9, 3.92576471365802*^9}, 3.925764852345087*^9, {
   3.925765033302147*^9, 3.925765037570284*^9}, {3.925765133824343*^9, 
   3.925765148142765*^9}, {3.925765233294443*^9, 3.925765237230718*^9}, {
   3.9257652915121098`*^9, 3.925765294068138*^9}, {3.925765457094633*^9, 
   3.925765459035845*^9}, {3.925765497804746*^9, 3.925765527866379*^9}, {
   3.925765592049179*^9, 3.925765594598753*^9}, {3.925765674614073*^9, 
   3.925765719265682*^9}, {3.925765773811725*^9, 3.9257657762356014`*^9}, {
   3.9257658964997463`*^9, 3.925765967175279*^9}, {3.925766082709196*^9, 
   3.92576617336842*^9}, {3.925766494702364*^9, 3.9257665278158073`*^9}, {
   3.925766714608393*^9, 3.925766724909759*^9}, {3.925766827869629*^9, 
   3.925766839966408*^9}, {3.92576745539686*^9, 3.9257675294091034`*^9}, {
   3.925767783175276*^9, 3.925767786072739*^9}, {3.925767816095484*^9, 
   3.925767821087335*^9}, {3.925767856469147*^9, 3.925767882682131*^9}, {
   3.9257679888899097`*^9, 3.925767995675283*^9}, 3.92576802588854*^9, {
   3.925768059173887*^9, 3.925768066139721*^9}, {3.925768102887821*^9, 
   3.925768106438523*^9}, {3.9257682435813255`*^9, 3.925768259492304*^9}, {
   3.92576830578463*^9, 3.925768357848825*^9}, {3.9257685169924316`*^9, 
   3.925768596409857*^9}, {3.925769288439884*^9, 3.925769296447954*^9}, {
   3.92576934762311*^9, 3.925769349827452*^9}, {3.9257694592575397`*^9, 
   3.925769485655443*^9}, {3.925769678504156*^9, 3.925769678727299*^9}, {
   3.925798064107907*^9, 3.925798097597662*^9}, 3.925798368239668*^9, 
   3.925800062246666*^9, {3.92580033944646*^9, 3.925800339523428*^9}, 
   3.9258004428998375`*^9, 3.9258011651070824`*^9, {3.928468596967619*^9, 
   3.9284685993838043`*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"9a090f92-b7ab-094f-a632-6e7a916f4f33"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"moneyC", "=", 
   RowBox[{"ebuynetC", "=", 
    RowBox[{"ebuywindC", "=", 
     RowBox[{"ebuylightC", "=", 
      RowBox[{"wasteC", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"i", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "24"}], "}"}]}], "]"}]}]}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"daypriceC", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"i", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1825"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"saveC", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"i", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "25"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"findminC", "[", 
   RowBox[{
    RowBox[{"power_", "?", "NumericQ"}], ",", 
    RowBox[{"energy_", "?", "NumericQ"}], ",", 
    RowBox[{"pv_", "?", "NumericQ"}], ",", 
    RowBox[{"pw_", "?", "NumericQ"}]}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{"(*", "C\:5730\:5149\:80fd\:53d1\:7535\:91cf", "*)"}], 
   RowBox[{
    RowBox[{"dataCproducelight", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"pv", "*", "#4"}], "&"}], "@@@", "dataproduce"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", "C\:5730\:98ce\:80fd\:53d1\:7535\:91cf", "*)"}], 
    RowBox[{"dataCproducewind", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"pw", "*", "#5"}], "&"}], "@@@", "dataproduce"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"saveC", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "=", 
     RowBox[{"energy", "*", "0.1"}]}], ";", "\n", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"dataCneed", "[", 
              RowBox[{"[", "hour", "]"}], "]"}], "<", 
             RowBox[{"dataCproducelight", "[", 
              RowBox[{"[", "hour", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"ebuylightC", "[", 
               RowBox[{"[", "hour", "]"}], "]"}], "=", 
              RowBox[{"dataCneed", "[", 
               RowBox[{"[", "hour", "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ebuywindC", "[", 
               RowBox[{"[", "hour", "]"}], "]"}], "=", "0"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ebuynetC", "[", 
               RowBox[{"[", "hour", "]"}], "]"}], "=", "0"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"wasteC", "[", 
               RowBox[{"[", "hour", "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"dataCproducelight", "[", 
                RowBox[{"[", "hour", "]"}], "]"}], "+", 
               RowBox[{"dataCproducewind", "[", 
                RowBox[{"[", "hour", "]"}], "]"}], "-", 
               RowBox[{"dataCneed", "[", 
                RowBox[{"[", "hour", "]"}], "]"}], "-", 
               RowBox[{"Min", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"dataCproducelight", "[", 
                    RowBox[{"[", "hour", "]"}], "]"}], "+", 
                    RowBox[{"dataCproducewind", "[", 
                    RowBox[{"[", "hour", "]"}], "]"}], "-", 
                    RowBox[{"dataCneed", "[", 
                    RowBox[{"[", "hour", "]"}], "]"}]}], ")"}], ",", 
                  "power"}], "}"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"moneyC", "[", 
               RowBox[{"[", "hour", "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"0.4", "*", 
                RowBox[{"ebuylightC", "[", 
                 RowBox[{"[", "hour", "]"}], "]"}]}], "+", 
               RowBox[{"0.5", "*", 
                RowBox[{"ebuywindC", "[", 
                 RowBox[{"[", "hour", "]"}], "]"}]}], "+", 
               RowBox[{"1", "*", 
                RowBox[{"ebuynetC", "[", 
                 RowBox[{"[", "hour", "]"}], "]"}]}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"saveC", "[", 
               RowBox[{"[", 
                RowBox[{"hour", "+", "1"}], "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"saveC", "[", 
                RowBox[{"[", "hour", "]"}], "]"}], "+", 
               RowBox[{"Min", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"dataCproducelight", "[", 
                    RowBox[{"[", "hour", "]"}], "]"}], "+", 
                    RowBox[{"dataCproducewind", "[", 
                    RowBox[{"[", "hour", "]"}], "]"}], "-", 
                    RowBox[{"dataCneed", "[", 
                    RowBox[{"[", "hour", "]"}], "]"}]}], ")"}], ",", 
                  "power"}], "}"}], "]"}]}]}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"dataCproducelight", "[", 
              RowBox[{"[", "hour", "]"}], "]"}], "<=", 
             RowBox[{"dataCneed", "[", 
              RowBox[{"[", "hour", "]"}], "]"}], "<", 
             RowBox[{
              RowBox[{"dataCproducelight", "[", 
               RowBox[{"[", "hour", "]"}], "]"}], "+", 
              RowBox[{"dataCproducewind", "[", 
               RowBox[{"[", "hour", "]"}], "]"}]}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"ebuylightC", "[", 
               RowBox[{"[", "hour", "]"}], "]"}], "=", 
              RowBox[{"dataCproducelight", "[", 
               RowBox[{"[", "hour", "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ebuywindC", "[", 
               RowBox[{"[", "hour", "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"dataCneed", "[", 
                RowBox[{"[", "hour", "]"}], "]"}], "-", 
               RowBox[{"dataCproducelight", "[", 
                RowBox[{"[", "hour", "]"}], "]"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ebuynetC", "[", 
               RowBox[{"[", "hour", "]"}], "]"}], "=", "0"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"wasteC", "[", 
               RowBox[{"[", "hour", "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"dataCproducelight", "[", 
                RowBox[{"[", "hour", "]"}], "]"}], "+", 
               RowBox[{"dataCproducewind", "[", 
                RowBox[{"[", "hour", "]"}], "]"}], "-", 
               RowBox[{"dataCneed", "[", 
                RowBox[{"[", "hour", "]"}], "]"}], "-", 
               RowBox[{"Min", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"dataCproducelight", "[", 
                    RowBox[{"[", "hour", "]"}], "]"}], "+", 
                    RowBox[{"dataCproducewind", "[", 
                    RowBox[{"[", "hour", "]"}], "]"}], "-", 
                    RowBox[{"dataCneed", "[", 
                    RowBox[{"[", "hour", "]"}], "]"}]}], ")"}], ",", 
                  "power"}], "}"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"moneyC", "[", 
               RowBox[{"[", "hour", "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"0.4", "*", 
                RowBox[{"ebuylightC", "[", 
                 RowBox[{"[", "hour", "]"}], "]"}]}], "+", 
               RowBox[{"0.5", "*", 
                RowBox[{"ebuywindC", "[", 
                 RowBox[{"[", "hour", "]"}], "]"}]}], "+", 
               RowBox[{"1", "*", 
                RowBox[{"ebuynetC", "[", 
                 RowBox[{"[", "hour", "]"}], "]"}]}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"saveC", "[", 
               RowBox[{"[", 
                RowBox[{"hour", "+", "1"}], "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"saveC", "[", 
                RowBox[{"[", "hour", "]"}], "]"}], "+", 
               RowBox[{"Min", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"dataCproducelight", "[", 
                    RowBox[{"[", "hour", "]"}], "]"}], "+", 
                    RowBox[{"dataCproducewind", "[", 
                    RowBox[{"[", "hour", "]"}], "]"}], "-", 
                    RowBox[{"dataCneed", "[", 
                    RowBox[{"[", "hour", "]"}], "]"}]}], ")"}], ",", 
                  "power"}], "}"}], "]"}]}]}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"dataCproducelight", "[", 
               RowBox[{"[", "hour", "]"}], "]"}], "+", 
              RowBox[{"dataCproducewind", "[", 
               RowBox[{"[", "hour", "]"}], "]"}]}], "<=", 
             RowBox[{"dataCneed", "[", 
              RowBox[{"[", "hour", "]"}], "]"}], "<", 
             RowBox[{
              RowBox[{"dataCproducelight", "[", 
               RowBox[{"[", "hour", "]"}], "]"}], "+", 
              RowBox[{"dataCproducewind", "[", 
               RowBox[{"[", "hour", "]"}], "]"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"saveC", "[", 
                  RowBox[{"[", "hour", "]"}], "]"}], "-", 
                 RowBox[{"energy", "*", "0.1"}]}], ")"}], "*", "0.95"}]}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"ebuylightC", "[", 
               RowBox[{"[", "hour", "]"}], "]"}], "=", 
              RowBox[{"dataCproducelight", "[", 
               RowBox[{"[", "hour", "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ebuywindC", "[", 
               RowBox[{"[", "hour", "]"}], "]"}], "=", 
              RowBox[{"dataCproducewind", "[", 
               RowBox[{"[", "hour", "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ebuynetC", "[", 
               RowBox[{"[", "hour", "]"}], "]"}], "=", "0"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"wasteC", "[", 
               RowBox[{"[", "hour", "]"}], "]"}], "=", "0"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"moneyC", "[", 
               RowBox[{"[", "hour", "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"0.4", "*", 
                RowBox[{"ebuylightC", "[", 
                 RowBox[{"[", "hour", "]"}], "]"}]}], "+", 
               RowBox[{"0.5", "*", 
                RowBox[{"ebuywindC", "[", 
                 RowBox[{"[", "hour", "]"}], "]"}]}], "+", 
               RowBox[{"1", "*", 
                RowBox[{"ebuynetC", "[", 
                 RowBox[{"[", "hour", "]"}], "]"}]}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"saveC", "[", 
               RowBox[{"[", 
                RowBox[{"hour", "+", "1"}], "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"saveC", "[", 
                RowBox[{"[", "hour", "]"}], "]"}], "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"dataCneed", "[", 
                   RowBox[{"[", "hour", "]"}], "]"}], "-", 
                  RowBox[{"dataCproducelight", "[", 
                   RowBox[{"[", "hour", "]"}], "]"}], "-", 
                  RowBox[{"dataCproducewind", "[", 
                   RowBox[{"[", "hour", "]"}], "]"}]}], ")"}], "/", 
                "0.95"}]}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"dataCneed", "[", 
              RowBox[{"[", "hour", "]"}], "]"}], ">=", 
             RowBox[{
              RowBox[{"dataCproducelight", "[", 
               RowBox[{"[", "hour", "]"}], "]"}], "+", 
              RowBox[{"dataCproducewind", "[", 
               RowBox[{"[", "hour", "]"}], "]"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"saveC", "[", 
                  RowBox[{"[", "hour", "]"}], "]"}], "-", 
                 RowBox[{"energy", "*", "0.1"}]}], ")"}], "*", "0.95"}]}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"ebuylightC", "[", 
               RowBox[{"[", "hour", "]"}], "]"}], "=", 
              RowBox[{"dataCproducelight", "[", 
               RowBox[{"[", "hour", "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ebuywindC", "[", 
               RowBox[{"[", "hour", "]"}], "]"}], "=", 
              RowBox[{"dataCproducewind", "[", 
               RowBox[{"[", "hour", "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ebuynetC", "[", 
               RowBox[{"[", "hour", "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"dataCneed", "[", 
                RowBox[{"[", "hour", "]"}], "]"}], "-", 
               RowBox[{"dataCproducelight", "[", 
                RowBox[{"[", "hour", "]"}], "]"}], "-", 
               RowBox[{"dataCproducewind", "[", 
                RowBox[{"[", "hour", "]"}], "]"}], "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"saveC", "[", 
                   RowBox[{"[", "hour", "]"}], "]"}], "-", 
                  RowBox[{"energy", "*", "0.1"}]}], ")"}], "*", "0.95"}]}]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"wasteC", "[", 
               RowBox[{"[", "hour", "]"}], "]"}], "=", "0"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"moneyC", "[", 
               RowBox[{"[", "hour", "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"0.4", "*", 
                RowBox[{"ebuylightC", "[", 
                 RowBox[{"[", "hour", "]"}], "]"}]}], "+", 
               RowBox[{"0.5", "*", 
                RowBox[{"ebuywindC", "[", 
                 RowBox[{"[", "hour", "]"}], "]"}]}], "+", 
               RowBox[{"1", "*", 
                RowBox[{"ebuynetC", "[", 
                 RowBox[{"[", "hour", "]"}], "]"}]}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"saveC", "[", 
               RowBox[{"[", 
                RowBox[{"hour", "+", "1"}], "]"}], "]"}], "=", 
              RowBox[{"energy", "*", "0.1"}]}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"saveC", "[", 
              RowBox[{"[", 
               RowBox[{"hour", "+", "1"}], "]"}], "]"}], ">", 
             RowBox[{"energy", "*", "0.9"}]}], ",", 
            RowBox[{
             RowBox[{"saveC", "[", 
              RowBox[{"[", 
               RowBox[{"hour", "+", "1"}], "]"}], "]"}], "=", 
             RowBox[{"energy", "*", "0.9"}]}]}], "]"}], ";"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"hour", ",", "1", ",", "24"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"daypriceC", "[", 
         RowBox[{"[", "day", "]"}], "]"}], "=", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"moneyC", "[", 
           RowBox[{"[", "hour", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"hour", ",", "1", ",", "24"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"saveC", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", 
        RowBox[{"saveC", "[", 
         RowBox[{"[", "25", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"day", ",", "1", ",", "1825"}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", "C\:5730\:4e94\:5e74\:8d2d\:7535\:603b\:6210\:672c", "*)"}], 
    RowBox[{"sumpriceC", "=", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"daypriceC", "[", 
         RowBox[{"[", "day", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"day", ",", "1", ",", "1825"}], "}"}]}], "]"}], "+", 
      RowBox[{"800", "*", "power"}], "+", 
      RowBox[{"1800", "*", "energy"}], "+", 
      RowBox[{"2500", "*", "pv"}], "+", 
      RowBox[{"3000", "*", "pw"}]}]}]}], ")"}]}]}], "Input",
 CellChangeTimes->{{3.925546379626629*^9, 3.925546424274025*^9}, {
   3.925546462474537*^9, 3.925546523886749*^9}, {3.925547021264038*^9, 
   3.925547022499193*^9}, {3.925547231194631*^9, 3.9255472319746113`*^9}, {
   3.9255479662407303`*^9, 3.9255479682428226`*^9}, {3.925548316825964*^9, 
   3.925548317476185*^9}, {3.925548496248872*^9, 3.925548500463852*^9}, {
   3.925548749353708*^9, 3.925548752472151*^9}, {3.925548846596615*^9, 
   3.925548848862692*^9}, {3.9255490265239964`*^9, 3.9255490340279827`*^9}, {
   3.9255514314566536`*^9, 3.9255514740045757`*^9}, {3.925551506336798*^9, 
   3.925551510869419*^9}, {3.925553501245318*^9, 3.925553531353609*^9}, {
   3.92555366317468*^9, 3.9255536644352264`*^9}, {3.925553709618667*^9, 
   3.925553762566099*^9}, {3.925587776885589*^9, 3.925587821806982*^9}, 
   3.9255894071846066`*^9, {3.925591240683975*^9, 3.925591244032122*^9}, {
   3.925591384026484*^9, 3.925591387211731*^9}, {3.925591614672934*^9, 
   3.925591790779505*^9}, {3.925591840431196*^9, 3.925591985330082*^9}, {
   3.9255920198621635`*^9, 3.925592041276238*^9}, 3.925592102742399*^9, {
   3.925592147909476*^9, 3.925592172337641*^9}, {3.925592250536743*^9, 
   3.925592262585039*^9}, 3.925592297839354*^9, {3.925592401067929*^9, 
   3.925592413898157*^9}, {3.925592933507189*^9, 3.92559302901*^9}, {
   3.925593880144177*^9, 3.925593886533213*^9}, {3.925594896141098*^9, 
   3.92559490753316*^9}, {3.925594994337925*^9, 3.9255950068597984`*^9}, {
   3.9255951828008595`*^9, 3.925595185007952*^9}, {3.9255954079673996`*^9, 
   3.925595410483143*^9}, {3.925595605939264*^9, 3.925595611432099*^9}, {
   3.925595645999943*^9, 3.925595652359543*^9}, {3.9255956972072983`*^9, 
   3.925595791042599*^9}, {3.9255958877138977`*^9, 3.925595897522236*^9}, 
   3.9255959468761272`*^9, {3.9255959782277536`*^9, 3.9255959815664215`*^9}, {
   3.925596018235041*^9, 3.92559621496991*^9}, {3.925596254828467*^9, 
   3.9255962856269855`*^9}, {3.9255963910145226`*^9, 
   3.9255965930384083`*^9}, {3.9255966316562653`*^9, 
   3.9255967595826416`*^9}, {3.925596796819788*^9, 3.925596983452553*^9}, {
   3.925597048787066*^9, 3.925597090267538*^9}, {3.925597285954542*^9, 
   3.925597291702275*^9}, {3.925599942538265*^9, 3.925599988731777*^9}, {
   3.9256000749711704`*^9, 3.925600161297499*^9}, {3.925600586511158*^9, 
   3.925600588235073*^9}, {3.925607148368105*^9, 3.9256071823465385`*^9}, {
   3.925610426304418*^9, 3.925610843468588*^9}, {3.9256111913586197`*^9, 
   3.925611193988628*^9}, {3.925611746130974*^9, 3.9256118054545918`*^9}, {
   3.925611841134533*^9, 3.925611974834287*^9}, {3.925612045642294*^9, 
   3.925612046728489*^9}, {3.9256120770019608`*^9, 3.925612115298937*^9}, {
   3.9256121652993164`*^9, 3.925612255452399*^9}, {3.925612347253371*^9, 
   3.925612513071747*^9}, {3.925612566478189*^9, 3.925612915961401*^9}, {
   3.925801023413053*^9, 3.925801025125519*^9}, {3.925801110498705*^9, 
   3.925801125730905*^9}, {3.925801170291548*^9, 3.9258012038841305`*^9}, {
   3.9258012363486*^9, 3.9258013394115734`*^9}, {3.9258014652261868`*^9, 
   3.925801466156451*^9}, {3.9258032730949574`*^9, 3.925803274842605*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"58f73b4c-ae49-3a42-830c-10ea52a8da75"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AbsoluteTiming", "[", 
  RowBox[{"Monitor", "[", 
   RowBox[{
    RowBox[{"NMinimize", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"findminC", "[", 
         RowBox[{"power", ",", "energy", ",", "pv", ",", "pw"}], "]"}], ",", 
        RowBox[{
         RowBox[{"0", "<=", "power", "<=", "1000"}], "&&", 
         RowBox[{"0", "<=", "energy", "<=", "1800"}], "&&", 
         RowBox[{"0", "<=", "pv", "<=", "1500"}], "&&", 
         RowBox[{"0", "<=", "pw", "<=", "2000"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"power", ",", "energy", ",", "pv", ",", "pw"}], "}"}], ",", 
      RowBox[{"Method", "->", 
       RowBox[{"{", 
        RowBox[{"\"\<NelderMead\>\"", ",", 
         RowBox[{"\"\<RandomSeed\>\"", "->", "100"}]}], "}"}]}], ",", 
      RowBox[{"WorkingPrecision", "->", "4"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"power", ",", "energy", ",", "pv", ",", "pw"}], "}"}]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.9258013670447273`*^9, 3.925801399769293*^9}, {
  3.925801591431116*^9, 3.925801591464121*^9}, {3.928407258075266*^9, 
  3.928407261762953*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"430e0688-8249-564f-bc0d-116b1ed6d181"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"96.3079569`", ",", 
   RowBox[{"{", 
    RowBox[{"1.68113122409410476684570313`4.*^7", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"power", "\[Rule]", "223.2253192999438886298`4."}], ",", 
       RowBox[{"energy", "\[Rule]", "518.9231611996755737383`4."}], ",", 
       RowBox[{"pv", "\[Rule]", "419.1980501559371159461`4."}], ",", 
       RowBox[{"pw", "\[Rule]", "1593.9331306917633896088`4."}]}], "}"}]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.925801582005396*^9, 3.925801687163988*^9, 
  3.9284073978015614`*^9, 3.9284687003727055`*^9},
 CellLabel->"Out[20]=",ExpressionUUID->"e76c1909-e548-d249-95b0-a1eb1f05a4a8"]
}, Open  ]]
},
Evaluator->"para1",
WindowSize->{1269, 721},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>0.8 Inherited,
FrontEndVersion->"14.0 for Microsoft Windows (64-bit) (2023\:5e7412\:670812\
\:65e5)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"02e1b3b5-778a-c345-b016-fb6c0623fe14"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 217, 3, 35, "Input",ExpressionUUID->"3f9b2d5e-c37c-4848-830c-4133de73b95b"],
Cell[778, 25, 3690, 96, 229, "Input",ExpressionUUID->"73e65a17-31ee-f64f-b155-ee8f52f04c2c"],
Cell[4471, 123, 13273, 308, 680, "Input",ExpressionUUID->"c738b972-614a-d147-8d27-9f18973eff8e"],
Cell[17747, 433, 2738, 49, 22, "Input",ExpressionUUID->"9a090f92-b7ab-094f-a632-6e7a916f4f33"],
Cell[20488, 484, 20288, 459, 886, "Input",ExpressionUUID->"58f73b4c-ae49-3a42-830c-10ea52a8da75"],
Cell[CellGroupData[{
Cell[40801, 947, 1225, 28, 63, "Input",ExpressionUUID->"430e0688-8249-564f-bc0d-116b1ed6d181"],
Cell[42029, 977, 685, 14, 28, "Output",ExpressionUUID->"e76c1909-e548-d249-95b0-a1eb1f05a4a8"]
}, Open  ]]
}
]
*)

